{{!< ../default}}

{{#if @member.paid}}
{{!-- Logged in, paying member: Redirect home --}}
<script>window.location = '{{@site.url}}';</script>

{{else if @member}}
{{!-- Logged in, not paying: Check out --}}
<div class="subscribe-page">
    <header class="post-header">
        <h1 class="post-title">Choose Your Subscription</h1>
        <div class="post-meta">
            Unlock full access to {{@site.title}}
        </div>
    </header>

    <div class="subscription-plans">
        {{#get "tiers" include="monthly_price,yearly_price,benefits" limit="10" as |tiers|}}
        {{#foreach tiers}}
        <div class="subscription-plan">
            <h3 class="plan-name">{{name}}</h3>

            {{#if monthly_price}}
            <div class="plan-price">
                ${{monthly_price}} / month
            </div>
            <button class="subscribe-button" data-members-plan="Monthly">
                Subscribe Monthly
            </button>
            {{/if}}

            {{#if yearly_price}}
            <div class="plan-price">
                ${{yearly_price}} / year
            </div>
            <button class="subscribe-button" data-members-plan="Yearly">
                Subscribe Yearly
            </button>
            {{/if}}

            {{#if benefits}}
            <ul class="plan-benefits">
                {{#foreach benefits}}
                <li>{{this}}</li>
                {{/foreach}}
            </ul>
            {{/if}}
        </div>
        {{/foreach}}
        {{/get}}
    </div>
</div>

{{else}}
{{!-- Not logged in: Sign up --}}
<div class="subscribe-page">
    <header class="post-header">
        <h1 class="post-title">Subscribe to {{@site.title}}</h1>
        <div class="post-meta">
            {{@site.description}}
        </div>
    </header>

    <form class="subscribe-form" data-members-form="signup">
        <div class="form-group">
            <label for="member-email">Email Address</label>
            <input id="member-email" type="email" data-members-email placeholder="your@email.com" required autocomplete="email" />
        </div>

        <div class="form-group">
            <label for="member-name">Name (Optional)</label>
            <input id="member-name" type="text" data-members-name placeholder="Your Name" autocomplete="name" />
        </div>


        <button type="submit" class="subscribe-button">
            <span class="button-text">Subscribe</span>
            <span class="button-loader">{{> "icons/loader"}}</span>
        </button>

        <p class="form-note">
            Already have an account? <a href="javascript:void(0)" onclick="if(window.ghost && window.ghost.portal) { window.ghost.portal.open({page: 'signin'}); } else { window.location.href = '{{@site.url}}/#/portal/signin'; }">Sign in</a>
        </p>

        <div class="message-success">
            <strong>Success!</strong> Check your inbox and click the link to confirm your subscription.
        </div>
        <div class="message-error">
            Please enter a valid email address.
        </div>
    </form>
</div>

{{/if}}