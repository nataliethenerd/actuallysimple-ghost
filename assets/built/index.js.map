{"version":3,"file":"index.js","sources":["../js/infiniteScroll.js","../js/menuOpen.js","../js/index.js"],"sourcesContent":["/*\r\nThis script continously loads post as the user scrolls the page. It uses the IntersectionObserver API to detect when the last post is in view. When the last post is in view, it fetches the next page and appends the posts to the page. It then checks if there is a next page and if there is, it continues to observe the last post. If there is no next page, it disconnects the observer. \r\n\r\nImportantly, for this script to work, it requires that each card have the `post` class and that the card container have the `gh-postfeed` class\r\n*/\r\n\r\nlet link = document.querySelector('link[rel=\"next\"]')?.getAttribute('href');\r\n\r\n// Fetch and parse next page\r\nasync function getNextPage(url) {\r\n    try {\r\n        const res = await fetch(url);\r\n        \r\n        if (!res.ok) {\r\n            throw new Error('Failed to fetch page')\r\n        }\r\n        \r\n        const nextPageHtml = await res.text();\r\n        const parser = new DOMParser();\r\n        const parsed = parser.parseFromString(nextPageHtml, 'text/html');\r\n        const posts = parsed.querySelectorAll('.post');\r\n        const nextLink = parsed.querySelector('link[rel=\"next\"]')?.getAttribute('href');\r\n        \r\n        return {posts, nextLink}\r\n\r\n    } catch (error) {\r\n        throw new Error(error)\r\n    }\r\n}\r\n\r\nexport default function infiniteScroll() {\r\n    \r\n    if (!link) { return; }\r\n\r\n    const options = {\r\n        // When the last card is within a 150px of the viewport, fetch the next page. This provides a smoother transition between pages \r\n       rootMargin: '150px',\r\n    }\r\n\r\n    const callback = (entries, observer) => {\r\n        try {\r\n            entries.forEach(entry => {\r\n            \r\n                if (entry.isIntersecting) {\r\n                    \r\n                    if (link) {\r\n                        getNextPage(link).then(({posts, nextLink}) => {\r\n                            posts.forEach(post => {\r\n                                document.querySelector('.gh-postfeed').append(post)\r\n                            })\r\n\r\n                            if (nextLink) {\r\n                                link = nextLink;\r\n                                observer.observe(document.querySelector('.post:last-of-type'))\r\n                            } else {\r\n                                observer.disconnect()\r\n                            }\r\n                        })\r\n                    }\r\n                }\r\n            })\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    }\r\n\r\n    let observer = new IntersectionObserver(callback, options);\r\n\r\n    observer.observe(document.querySelector('.post:last-of-type'))\r\n\r\n}","// Toggle the menu open and close when on mobile\r\nexport default function menuOpen() {\r\n    const burgerButton = document.querySelector('.gh-burger');\r\n    burgerButton.addEventListener('click', function () {\r\n        document.body.classList.toggle('gh-head-open');\r\n    });\r\n}","// JavaScript files are compiled and minified during the build process to the assets/built folder. See available scripts in the package.json file.\r\n\r\n// Import CSS\r\nimport \"../css/index.css\";\r\n\r\n// Import JS\r\nimport menuOpen from \"./menuOpen\";\r\nimport infiniteScroll from \"./infiniteScroll\";\r\n\r\n// Dark mode functionality\r\nfunction initDarkMode() {\r\n    // Check for saved theme preference or default to light mode\r\n    const savedTheme = localStorage.getItem('theme') || 'light';\r\n    document.documentElement.setAttribute('data-theme', savedTheme);\r\n\r\n    // Wait for DOM to be ready\r\n    document.addEventListener('DOMContentLoaded', function() {\r\n        const toggleButton = document.getElementById('dark-mode-toggle');\r\n        const toggleIcon = toggleButton ? toggleButton.querySelector('.toggle-icon') : null;\r\n\r\n        if (toggleButton && toggleIcon) {\r\n            // Update button to match current theme\r\n            toggleIcon.textContent = savedTheme === 'dark' ? '☀' : '☽';\r\n            toggleButton.setAttribute('title', savedTheme === 'dark' ? 'Switch to light mode' : 'Switch to dark mode');\r\n\r\n            // Add click event listener\r\n            toggleButton.addEventListener('click', function() {\r\n                const currentTheme = document.documentElement.getAttribute('data-theme');\r\n                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';\r\n\r\n                document.documentElement.setAttribute('data-theme', newTheme);\r\n                localStorage.setItem('theme', newTheme);\r\n                toggleIcon.textContent = newTheme === 'dark' ? '☀' : '☽';\r\n                toggleButton.setAttribute('title', newTheme === 'dark' ? 'Switch to light mode' : 'Switch to dark mode');\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\n// Subscribe button feedback functionality\r\nfunction initSubscribeButtons() {\r\n    // Function to add button feedback\r\n    function addButtonFeedback(button) {\r\n        console.log('Adding feedback to button:', button);\r\n\r\n        // Add loading state\r\n        button.classList.add('loading');\r\n        button.disabled = true;\r\n\r\n        console.log('Button classes after loading:', button.classList.toString());\r\n\r\n        // Simulate loading time\r\n        setTimeout(() => {\r\n            button.classList.remove('loading');\r\n            button.classList.add('success');\r\n            button.disabled = false;\r\n\r\n            console.log('Button classes after success:', button.classList.toString());\r\n\r\n            // Reset after 3 seconds\r\n            setTimeout(() => {\r\n                button.classList.remove('success');\r\n                console.log('Button reset, classes:', button.classList.toString());\r\n            }, 3000);\r\n        }, 1500);\r\n    }\r\n\r\n    // Wait for DOM to be ready\r\n    if (document.readyState === 'loading') {\r\n        document.addEventListener('DOMContentLoaded', initButtons);\r\n    } else {\r\n        initButtons();\r\n    }\r\n\r\n    function initButtons() {\r\n        console.log('Initializing subscribe buttons...');\r\n\r\n        // Handle all subscribe buttons with delegation\r\n        document.addEventListener('click', function(e) {\r\n            const button = e.target;\r\n\r\n            // Check if clicked element is a subscribe button\r\n            if (button.matches('.subscribe-button, .newsletter-button') ||\r\n                button.matches('.sidebar-newsletter-form button[type=\"submit\"]') ||\r\n                button.matches('[data-members-form] button[type=\"submit\"]')) {\r\n\r\n                console.log('Subscribe button clicked:', button);\r\n\r\n                // Prevent double-processing\r\n                if (button.classList.contains('loading') || button.classList.contains('success')) {\r\n                    return;\r\n                }\r\n\r\n                addButtonFeedback(button);\r\n            }\r\n        });\r\n\r\n        // Also handle form submissions\r\n        document.addEventListener('submit', function(e) {\r\n            if (e.target.matches('[data-members-form]')) {\r\n                const submitButton = e.target.querySelector('button[type=\"submit\"]');\r\n                if (submitButton && !submitButton.classList.contains('loading')) {\r\n                    console.log('Form submitted, adding feedback to button:', submitButton);\r\n                    addButtonFeedback(submitButton);\r\n                }\r\n            }\r\n        });\r\n\r\n        console.log('Subscribe button initialization complete');\r\n    }\r\n}\r\n\r\n// Call the functions\r\nmenuOpen();\r\ninfiniteScroll();\r\ninitDarkMode();\r\ninitSubscribeButtons();"],"names":["link","document","querySelector","getAttribute","addEventListener","body","classList","toggle","IntersectionObserver","callback","entries","observer","forEach","entry","isIntersecting","async","url","res","fetch","ok","Error","nextPageHtml","text","parsed","DOMParser","parseFromString","posts","querySelectorAll","nextLink","error","getNextPage","then","_ref","post","append","observe","disconnect","console","log","rootMargin","infiniteScroll","savedTheme","localStorage","getItem","documentElement","setAttribute","toggleButton","getElementById","toggleIcon","textContent","newTheme","setItem","initDarkMode","addButtonFeedback","button","add","disabled","toString","setTimeout","remove","initButtons","e","target","matches","contains","submitButton","readyState","initSubscribeButtons"],"mappings":"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"}